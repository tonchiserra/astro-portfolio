---
import { getCollection } from 'astro:content';
import SectionHeading from '@components/ui/SectionHeading.astro';
import TimelineItem from '@components/ui/TimelineItem.astro';
import ProjectCard from '@components/ui/ProjectCard.astro';
import experienceData from '@data/experience.json';

const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter((p) => p.data.featured)
  .sort((a, b) => a.data.order - b.data.order);
---

<section id="experience" class="py-24 max-w-5xl mx-auto px-6">
  <SectionHeading title="Experience" number="01" />

  <div class="max-w-3xl mb-20" data-animate>
    {experienceData.map((job) => (
      <TimelineItem
        role={job.role}
        company={job.company}
        companyUrl={job.companyUrl}
        period={job.period}
        location={job.location}
        description={job.description}
        highlights={job.highlights}
      />
    ))}
  </div>

  <div>
    <h3 class="text-lg font-bold tracking-tight mb-2">Collaborative Projects</h3>
    <p class="text-sm text-text-muted mb-8">Brands and stores I've contributed to as part of the team.</p>

    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-5" data-animate>
      {featuredProjects.map((project) => (
        <ProjectCard
          slug={project.id}
          title={project.data.title}
          client={project.data.client}
          description={project.data.description}
          tags={project.data.tags}
          url={project.data.url}
        />
      ))}
    </div>
  </div>
</section>
